local player = game.Players.LocalPlayer
local replicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")

local autoSellRunning = false
local autoClickerRunning = false
local fpsBoostEnabled = false
local clickerDelay = 0.05
local activeIsland = nil
local clickPosition = nil
local settingClickPosition = false
local fishCount = 0
local autoSellThreshold = 50

local autoFishWasOn = false
local autoSellWasOn = false
local autoClickerWasOn = false
local fpsBoostWasOn = false

local gui, clickIndicator, autoClickerToggle, closeBtn
local allGuiElements = {}
local protectedElements = {}
local originalLightingSettings = {}

local islands = {
    { Name = "Esoteric Depths", Position = Vector3.new(3206.46, -1302.85, 1442.03), LookAt = Vector3.new(3300, -1300, 400) },
    { Name = "Treasure Room", Position = Vector3.new(-3611.89, -279.07, -1589.51), LookAt = Vector3.new(-3619.21, -286.53, -1602.57) },
    { Name = "Lost Isle", Position = Vector3.new(-3738.2, -135.1, -1011.9), LookAt = Vector3.new(-3600, -135, -1200) },
}

local function getFishCount()
    local count = 0
    pcall(function()
        for _, gui in pairs(player.PlayerGui:GetDescendants()) do
            if (gui:IsA("TextLabel") or gui:IsA("TextButton")) and gui.Visible then
                local currentFish = gui.Text:match("(%d+)/")
                if currentFish then
                    local fishNum = tonumber(currentFish)
                    if fishNum and fishNum > count then
                        count = fishNum
                    end
                end
            end
        end
    end)
    return count
end

local function sellAllFish()
    pcall(function()
        local net = replicatedStorage:FindFirstChild("Packages")
        if not net then return end
        local idx = net:FindFirstChild("_Index")
        if not idx then return end
        local sleitnick = idx:FindFirstChild("sleitnick_net@0.2.0")
        if not sleitnick then return end
        local netFolder = sleitnick:FindFirstChild("net")
        if not netFolder then return end
        for _, remote in ipairs(netFolder:GetDescendants()) do
            if remote:IsA("RemoteFunction") or remote:IsA("RemoteEvent") then
                local name = remote.Name:lower()
                if name:find("sell") and not name:find("buy") then
                    pcall(function()
                        if remote:IsA("RemoteFunction") then
                            remote:InvokeServer()
                        else
                            remote:FireServer()
                        end
                    end)
                    task.wait(0.5)
                end
            end
        end
    end)
end

local function autoSellLoop()
    task.spawn(function()
        while autoSellRunning do
            task.wait(15)
            fishCount = getFishCount()
            if fishCount >= autoSellThreshold then
                sellAllFish()
                task.wait(3)
            end
        end
    end)
end

local function enableAutoFish()
    task.spawn(function()
        local char = player.Character
        if not char then return end
        local hasRod = false
        for _, tool in pairs(char:GetChildren()) do
            if tool:IsA("Tool") and tool.Name:lower():find("rod") then
                hasRod = true
                break
            end
        end
        if not hasRod then
            for _, tool in pairs(player.Backpack:GetChildren()) do
                if tool:IsA("Tool") and tool.Name:lower():find("rod") then
                    char.Humanoid:EquipTool(tool)
                    hasRod = true
                    break
                end
            end
        end
        if not hasRod then
            game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.One, false, game)
            task.wait(0.3)
        end
        task.wait(0.5)
        local net = replicatedStorage:FindFirstChild("Packages")
        if net then
            local idx = net:FindFirstChild("_Index")
            if idx then
                local sleitnick = idx:FindFirstChild("sleitnick_net@0.2.0")
                if sleitnick then
                    local netFolder = sleitnick:FindFirstChild("net")
                    if netFolder then
                        local rfFolder = netFolder:FindFirstChild("RF/UpdateAutoFishingState")
                        if rfFolder and rfFolder:IsA("RemoteFunction") then
                            task.wait(0.5)
                            pcall(function() rfFolder:InvokeServer(true) end)
                        end
                    end
                end
            end
        end
    end)
end

local function enableFPSBoost()
    originalLightingSettings = {
        Brightness = Lighting.Brightness,
        GlobalShadows = Lighting.GlobalShadows,
        OutdoorAmbient = Lighting.OutdoorAmbient,
        Technology = Lighting.Technology,
        FogEnd = Lighting.FogEnd,
        FogStart = Lighting.FogStart,
    }
    settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
    settings().Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Level01
    Lighting.GlobalShadows = false
    Lighting.Brightness = 2
    Lighting.OutdoorAmbient = Color3.fromRGB(200, 200, 200)
    Lighting.Technology = Enum.Technology.Compatibility
    Lighting.FogEnd = 100
    Lighting.FogStart = 0
    for _, effect in ipairs(Lighting:GetChildren()) do
        pcall(function()
            if effect:IsA("PostEffect") or effect:IsA("BloomEffect") or effect:IsA("BlurEffect") or 
               effect:IsA("ColorCorrectionEffect") or effect:IsA("SunRaysEffect") or 
               effect:IsA("DepthOfFieldEffect") then
                effect.Enabled = false
            elseif effect:IsA("Atmosphere") or effect:IsA("Sky") then
                effect:Destroy()
            end
        end)
    end
    task.spawn(function()
        for _, obj in pairs(workspace:GetDescendants()) do
            pcall(function()
                if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or 
                   obj:IsA("Fire") or obj:IsA("Sparkles") or obj:IsA("PointLight") or 
                   obj:IsA("SpotLight") or obj:IsA("SurfaceLight") then
                    obj.Enabled = false
                elseif obj:IsA("BasePart") then
                    obj.CastShadow = false
                    obj.Material = Enum.Material.SmoothPlastic
                    obj.Reflectance = 0
                elseif obj:IsA("Decal") or obj:IsA("Texture") then
                    obj.Transparency = 1
                elseif obj:IsA("MeshPart") then
                    obj.RenderFidelity = Enum.RenderFidelity.Performance
                    obj.Material = Enum.Material.SmoothPlastic
                    obj.CastShadow = false
                end
            end)
        end
    end)
    pcall(function()
        workspace.Terrain.WaterTransparency = 1
        workspace.Terrain.WaterReflectance = 0
        workspace.Terrain.WaterWaveSize = 0
        workspace.Terrain.WaterWaveSpeed = 0
    end)
    UserSettings():GetService("UserGameSettings").SavedQualityLevel = Enum.SavedQualitySetting.QualityLevel1
end

local function disableFPSBoost()
    if originalLightingSettings.Brightness then
        Lighting.Brightness = originalLightingSettings.Brightness
        Lighting.GlobalShadows = originalLightingSettings.GlobalShadows
        Lighting.OutdoorAmbient = originalLightingSettings.OutdoorAmbient
        Lighting.Technology = originalLightingSettings.Technology or Enum.Technology.ShadowMap
        Lighting.FogEnd = originalLightingSettings.FogEnd or 100000
        Lighting.FogStart = originalLightingSettings.FogStart or 0
    end
    settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
    for _, effect in ipairs(Lighting:GetChildren()) do
        if effect:IsA("PostEffect") then
            effect.Enabled = true
        end
    end
    pcall(function()
        workspace.Terrain.WaterTransparency = 0.3
        workspace.Terrain.WaterReflectance = 1
        workspace.Terrain.WaterWaveSize = 0.15
        workspace.Terrain.WaterWaveSpeed = 10
    end)
end

local function teleportAndFace()
    local char = player.Character
    if not (char and char:FindFirstChild("HumanoidRootPart") and activeIsland) then return end
    local hrp = char.HumanoidRootPart
    hrp.CFrame = CFrame.new(activeIsland.Position + Vector3.new(0, 5, 0))
    task.wait(0.4)
    local waterPart = nil
    local shortestDist = math.huge
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and obj.Name:lower():find("water") then
            local dist = (obj.Position - hrp.Position).Magnitude
            if dist < shortestDist and dist < 300 then
                shortestDist = dist
                waterPart = obj
            end
        end
    end
    if waterPart then
        hrp.CFrame = CFrame.lookAt(hrp.Position, waterPart.Position)
    else
        hrp.CFrame = CFrame.lookAt(hrp.Position, activeIsland.LookAt)
    end
end

local function isMouseOverGui()
    if not gui then return false end
    local mousePos = UserInputService:GetMouseLocation()
    local guiObjects = player.PlayerGui:GetGuiObjectsAtPosition(mousePos.X, mousePos.Y)
    for _, obj in ipairs(guiObjects) do
        if obj:IsDescendantOf(gui) then
            return true
        end
    end
    return false
end

local function setGuiInteractable(enabled)
    for _, element in ipairs(allGuiElements) do
        if element and element.Parent then
            local isProtected = false
            for _, protected in ipairs(protectedElements) do
                if element == protected then
                    isProtected = true
                    break
                end
            end
            if not isProtected and element:GetAttribute("OriginalTransparency") then
                element.BackgroundTransparency = enabled and element:GetAttribute("OriginalTransparency") or 0.7
            end
        end
    end
end

local function stopAutoClicker()
    autoClickerRunning = false
    setGuiInteractable(true)
    if not settingClickPosition then
        clickIndicator.Visible = false
    end
    if autoClickerToggle then
        local sliderBg = autoClickerToggle:FindFirstChild("Frame")
        local knob = sliderBg and sliderBg:FindFirstChild("Frame")
        if sliderBg and knob then
            TweenService:Create(sliderBg, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 115)}):Play()
            TweenService:Create(knob, TweenInfo.new(0.2), {Position = UDim2.new(0, 1, 0.5, -3)}):Play()
        end
    end
end

local function autoClickerLoop()
    task.spawn(function()
        while autoClickerRunning do
            pcall(function()
                if clickPosition and closeBtn then
                    local closePos = closeBtn.AbsolutePosition
                    local closeSize = closeBtn.AbsoluteSize
                    local shouldClick = not (
                        clickPosition.X >= closePos.X and 
                        clickPosition.X <= closePos.X + closeSize.X and
                        clickPosition.Y >= closePos.Y and 
                        clickPosition.Y <= closePos.Y + closeSize.Y
                    )
                    if shouldClick then
                        local VirtualInputManager = game:GetService("VirtualInputManager")
                        VirtualInputManager:SendMouseButtonEvent(clickPosition.X, clickPosition.Y, 0, true, game, 0)
                        task.wait(0.01)
                        VirtualInputManager:SendMouseButtonEvent(clickPosition.X, clickPosition.Y, 0, false, game, 0)
                    end
                elseif not isMouseOverGui() then
                    mouse1click()
                end
            end)
            task.wait(clickerDelay)
        end
    end)
end

UserInputService.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton2 and autoClickerRunning then
        stopAutoClicker()
    end
end)

local function createCategoryHeader(parent, text)
    local header = Instance.new("TextLabel", parent)
    header.Size = UDim2.new(1, -15, 0, 12)
    header.Text = text
    header.TextColor3 = Color3.fromRGB(180, 190, 255)
    header.Font = Enum.Font.GothamBold
    header.TextSize = 9
    header.BackgroundTransparency = 1
    header.TextXAlignment = Enum.TextXAlignment.Left
    return header
end

local function createModernToggle(parent, labelText, onToggleCallback)
    local holder = Instance.new("TextButton", parent)
    holder.Size = UDim2.new(1, -18, 0, 18)
    holder.BackgroundColor3 = Color3.fromRGB(32, 36, 55)
    holder.BackgroundTransparency = 0.18
    holder.BorderSizePixel = 0
    holder.Text = ""
    holder.AutoButtonColor = false
    Instance.new("UICorner", holder).CornerRadius = UDim.new(0, 4)
    local label = Instance.new("TextLabel", holder)
    label.Size = UDim2.new(1, -20, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(225, 235, 250)
    label.Font = Enum.Font.Gotham
    label.TextSize = 8
    label.BackgroundTransparency = 1
    label.TextXAlignment = Enum.TextXAlignment.Left
    local sliderBg = Instance.new("Frame", holder)
    sliderBg.Size = UDim2.new(0, 16, 0, 8)
    sliderBg.Position = UDim2.new(1, -20, 0.5, -4)
    sliderBg.BackgroundColor3 = Color3.fromRGB(90, 90, 110)
    sliderBg.BorderSizePixel = 0
    sliderBg.ZIndex = 2
    Instance.new("UICorner", sliderBg).CornerRadius = UDim.new(1, 0)
    local knob = Instance.new("Frame", sliderBg)
    knob.Size = UDim2.new(0, 7, 0, 7)
    knob.Position = UDim2.new(0, 1, 0.5, -3)
    knob.BackgroundColor3 = Color3.fromRGB(240, 240, 245)
    knob.BorderSizePixel = 0
    knob.ZIndex = 3
    Instance.new("UICorner", knob).CornerRadius = UDim.new(1, 0)
    local isOn = false
    local function setVisual(state)
        if state then
            TweenService:Create(sliderBg, TweenInfo.new(0.18), {BackgroundColor3 = Color3.fromRGB(85, 140, 255)}):Play()
            TweenService:Create(knob, TweenInfo.new(0.18), {Position = UDim2.new(1, -8, 0.5, -3)}):Play()
        else
            TweenService:Create(sliderBg, TweenInfo.new(0.18), {BackgroundColor3 = Color3.fromRGB(90, 90, 110)}):Play()
            TweenService:Create(knob, TweenInfo.new(0.18), {Position = UDim2.new(0, 1, 0.5, -3)}):Play()
        end
    end
    holder.MouseButton1Click:Connect(function()
        isOn = not isOn
        setVisual(isOn)
        if onToggleCallback then onToggleCallback(isOn, holder) end
    end)
    setVisual(false)
    return holder
end

local function createButton(parent, labelText, onClickCallback)
    local holder = Instance.new("TextButton", parent)
    holder.Size = UDim2.new(1, -18, 0, 15)
    holder.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    holder.BackgroundTransparency = 0.13
    holder.BorderSizePixel = 0
    holder.Text = labelText
    holder.TextColor3 = Color3.fromRGB(255, 255, 255)
    holder.Font = Enum.Font.GothamBold
    holder.TextSize = 8
    holder.AutoButtonColor = false
    Instance.new("UICorner", holder).CornerRadius = UDim.new(0, 3)
    holder.MouseButton1Click:Connect(function()
        if onClickCallback then onClickCallback() end
    end)
    return holder
end

local function createSlider(parent, labelText, minVal, maxVal, defaultVal, onValueChanged)
    local holder = Instance.new("Frame", parent)
    holder.Size = UDim2.new(1, -18, 0, 15)
    holder.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    holder.BackgroundTransparency = 0.15
    holder.BorderSizePixel = 0
    Instance.new("UICorner", holder).CornerRadius = UDim.new(0, 3)
    local label = Instance.new("TextLabel", holder)
    label.Size = UDim2.new(1, -28, 0, 9)
    label.Position = UDim2.new(0, 6, 0, 2)
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(210, 220, 245)
    label.Font = Enum.Font.Gotham
    label.TextSize = 8
    label.BackgroundTransparency = 1
    label.TextXAlignment = Enum.TextXAlignment.Left
    local valueLabel = Instance.new("TextLabel", holder)
    valueLabel.Size = UDim2.new(0, 25, 0, 9)
    valueLabel.Position = UDim2.new(1, -26, 0, 2)
    valueLabel.Text = tostring(defaultVal) .. " CPS"
    valueLabel.TextColor3 = Color3.fromRGB(180, 190, 255)
    valueLabel.Font = Enum.Font.GothamBold
    valueLabel.TextSize = 8
    valueLabel.BackgroundTransparency = 1
    local sliderFrame = Instance.new("Frame", holder)
    sliderFrame.Size = UDim2.new(1, -10, 0, 2)
    sliderFrame.Position = UDim2.new(0, 5, 0, 11)
    sliderFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 85)
    sliderFrame.BorderSizePixel = 0
    Instance.new("UICorner", sliderFrame).CornerRadius = UDim.new(1, 0)
    local sliderFill = Instance.new("Frame", sliderFrame)
    sliderFill.Size = UDim2.new((defaultVal - minVal) / (maxVal - minVal), 0, 1, 0)
    sliderFill.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    sliderFill.BorderSizePixel = 0
    Instance.new("UICorner", sliderFill).CornerRadius = UDim.new(1, 0)
    local sliderButton = Instance.new("TextButton", sliderFrame)
    sliderButton.Size = UDim2.new(0, 7, 0, 7)
    sliderButton.Position = UDim2.new((defaultVal - minVal) / (maxVal - minVal), -4, 0.5, -3)
    sliderButton.BackgroundColor3 = Color3.fromRGB(220, 220, 230)
    sliderButton.Text = ""
    sliderButton.BorderSizePixel = 0
    Instance.new("UICorner", sliderButton).CornerRadius = UDim.new(1, 0)
    local dragging = false
    local function updateSlider(pos)
        local sliderPos = sliderFrame.AbsolutePosition.X
        local sliderSize = sliderFrame.AbsoluteSize.X
        local percentage = math.clamp((pos - sliderPos) / sliderSize, 0, 1)
        local value = math.floor(minVal + (maxVal - minVal) * percentage)
        sliderButton.Position = UDim2.new(percentage, -4, 0.5, -3)
        sliderFill.Size = UDim2.new(percentage, 0, 1, 0)
        valueLabel.Text = tostring(value) .. " CPS"
        if onValueChanged then onValueChanged(value) end
    end
    sliderButton.MouseButton1Down:Connect(function() dragging = true end)
    sliderButton.TouchPan:Connect(function(touchPositions, totalTranslation, velocity, userInputState)
        if userInputState == Enum.UserInputState.Change and touchPositions[1] then
            dragging = true
            updateSlider(touchPositions[1].X)
        elseif userInputState == Enum.UserInputState.End then
            dragging = false
        end
    end)
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging then
            local pos
            if input.UserInputType == Enum.UserInputType.MouseMovement then
                pos = UserInputService:GetMouseLocation().X
            elseif input.UserInputType == Enum.UserInputType.Touch then
                pos = input.Position.X
            end
            if pos then updateSlider(pos) end
        end
    end)
    return holder
end

local function buildUI()
    if gui then return end
    local blur = Instance.new("BlurEffect")
    blur.Size = 12
    blur.Parent = Lighting
    gui = Instance.new("ScreenGui")
    gui.Name = "FishItGlassHub"
    gui.ResetOnSpawn = false
    gui.Parent = player.PlayerGui

    local vps = workspace.CurrentCamera.ViewportSize
    local scrW, scrH = vps.X, vps.Y
    local minW, maxW = 146, 220
    local minH, maxH = 76, 148
    local targetW = math.clamp(math.floor(scrW * 0.146), minW, maxW)
    local targetH = math.clamp(math.floor(scrH * 0.15), minH, maxH)

    local mainFrame = Instance.new("Frame", gui)
    mainFrame.Size = UDim2.new(0, targetW, 0, targetH)
    mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    mainFrame.BackgroundColor3 = Color3.fromRGB(26, 28, 35)
    mainFrame.BorderSizePixel = 0
    Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 6)
    local mainStroke = Instance.new("UIStroke", mainFrame)
    mainStroke.Color = Color3.fromRGB(60, 60, 75)
    mainStroke.Thickness = 1.5

    local sidebarW = math.max(math.floor(targetW * 0.28), 24)
    local sidebar = Instance.new("Frame", mainFrame)
    sidebar.Size = UDim2.new(0, sidebarW, 1, -11)
    sidebar.Position = UDim2.new(0, 3, 0, 9)
    sidebar.BackgroundColor3 = Color3.fromRGB(18, 20, 28)
    sidebar.BackgroundTransparency = 0.19
    sidebar.BorderSizePixel = 0
    Instance.new("UICorner", sidebar).CornerRadius = UDim.new(0, 4)

    local function createTabBtn(text, yPos)
        local btn = Instance.new("TextButton", sidebar)
        btn.Size = UDim2.new(1, -4, 0, 10)
        btn.Position = UDim2.new(0, 2, 0, yPos)
        btn.BackgroundTransparency = 1
        btn.Text = text
        btn.TextColor3 = Color3.fromRGB(210, 215, 230)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 8
        btn.AutoButtonColor = false
        btn.TextXAlignment = Enum.TextXAlignment.Left
        return btn
    end

    local infoBtn = createTabBtn("Information", 4)
    local featuresBtn = createTabBtn("Features", 17)
    local teleportBtn = createTabBtn("Teleport", 31)

    local contentW = targetW - sidebarW - 7
    local contentH = targetH - 12
    local contentContainer = Instance.new("Frame", mainFrame)
    contentContainer.Size = UDim2.new(0, contentW, 0, contentH)
    contentContainer.Position = UDim2.new(0, sidebarW + 4, 0, 8)
    contentContainer.BackgroundTransparency = 1
    contentContainer.BorderSizePixel = 0

    local infoPage = Instance.new("Frame", contentContainer)
    infoPage.Name = "InfoPage"
    infoPage.Size = UDim2.new(1, 0, 1, 0)
    infoPage.BackgroundTransparency = 1
    infoPage.Visible = true

    local infoText = Instance.new("TextLabel", infoPage)
    infoText.Size = UDim2.new(1, -7, 1, -10)
    infoText.Position = UDim2.new(0, 3, 0, 5)
    infoText.BackgroundTransparency = 1
    infoText.TextWrapped = true
    infoText.TextColor3 = Color3.fromRGB(220, 220, 240)
    infoText.Font = Enum.Font.GothamBold
    infoText.TextSize = 8
    infoText.Text = "Script developed by Einhard and made with luv"
    infoText.TextXAlignment = Enum.TextXAlignment.Center
    infoText.TextYAlignment = Enum.TextYAlignment.Center

    local featuresPage = Instance.new("ScrollingFrame", contentContainer)
    featuresPage.Name = "FeaturesPage"
    featuresPage.Size = UDim2.new(1, 0, 1, 0)
    featuresPage.BackgroundTransparency = 1
    featuresPage.BorderSizePixel = 0
    featuresPage.ScrollBarThickness = 2
    featuresPage.CanvasSize = UDim2.new(0, 0, 0, 0)
    featuresPage.Visible = false

    local fLayout = Instance.new("UIListLayout", featuresPage)
    fLayout.SortOrder = Enum.SortOrder.LayoutOrder
    fLayout.Padding = UDim.new(0, 2)

    local teleportPage = Instance.new("ScrollingFrame", contentContainer)
    teleportPage.Name = "TeleportPage"
    teleportPage.Size = UDim2.new(1, 0, 1, 0)
    teleportPage.BackgroundTransparency = 1
    teleportPage.BorderSizePixel = 0
    teleportPage.ScrollBarThickness = 2
    teleportPage.CanvasSize = UDim2.new(0, 0, 0, 0)
    teleportPage.Visible = false

    local tLayout = Instance.new("UIListLayout", teleportPage)
    tLayout.SortOrder = Enum.SortOrder.LayoutOrder
    tLayout.Padding = UDim.new(0, 2)

    local function showPage(page)
        infoPage.Visible = false
        featuresPage.Visible = false
        teleportPage.Visible = false
        page.Visible = true
    end

    infoBtn.MouseButton1Click:Connect(function() showPage(infoPage) end)
    featuresBtn.MouseButton1Click:Connect(function() showPage(featuresPage) end)
    teleportBtn.MouseButton1Click:Connect(function() showPage(teleportPage) end)

    createCategoryHeader(featuresPage, "FISHING")
    createModernToggle(featuresPage, "Auto Fish", function(isOn) autoFishWasOn = isOn if isOn then enableAutoFish() end end)
    createModernToggle(featuresPage, "Auto Sell (500 fish)", function(isOn) autoSellWasOn = isOn autoSellRunning = isOn if isOn then autoSellLoop() end end)
    createCategoryHeader(featuresPage, "AUTO CLICKER")
    createSlider(featuresPage, "Click Speed", 1, 50, 20, function(value) clickerDelay = 1 / value end)
    createButton(featuresPage, "Set Click Position", function()
        settingClickPosition = true
        if not clickIndicator then
            clickIndicator = Instance.new("TextButton", gui)
            clickIndicator.Size = UDim2.new(0, 28, 0, 28)
            clickIndicator.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
            clickIndicator.BackgroundTransparency = 0.4
            clickIndicator.BorderSizePixel = 0
            clickIndicator.Visible = false
            clickIndicator.ZIndex = 10
            clickIndicator.Text = ""
            clickIndicator.AutoButtonColor = false
            Instance.new("UICorner", clickIndicator).CornerRadius = UDim.new(1, 0)
            local innerCircle = Instance.new("Frame", clickIndicator)
            innerCircle.Size = UDim2.new(0, 6, 0, 6)
            innerCircle.Position = UDim2.new(0.5, -3, 0.5, -3)
            innerCircle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            innerCircle.BorderSizePixel = 0
            Instance.new("UICorner", innerCircle).CornerRadius = UDim.new(1, 0)
        end
        clickIndicator.Visible = true
        local connection
        connection = UserInputService.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                local mousePos = UserInputService:GetMouseLocation()
                clickPosition = Vector2.new(mousePos.X, mousePos.Y)
                clickIndicator.Position = UDim2.new(0, mousePos.X - 14, 0, mousePos.Y - 14)
                settingClickPosition = false
                connection:Disconnect()
            end
        end)
    end)
    autoClickerToggle = createModernToggle(featuresPage, "Enable Auto Clicker", function(isOn)
        autoClickerWasOn = isOn
        autoClickerRunning = isOn
        if isOn then 
            autoClickerLoop()
            setGuiInteractable(false)
            if clickPosition then clickIndicator.Visible = true end
        else
            stopAutoClicker()
        end
    end)
    createCategoryHeader(featuresPage, "PERFORMANCE")
    createModernToggle(featuresPage, "FPS Boost", function(isOn) fpsBoostWasOn = isOn fpsBoostEnabled = isOn if isOn then enableFPSBoost() else disableFPSBoost() end end)

    for i, island in ipairs(islands) do
        createModernToggle(teleportPage, island.Name, function(isOn, clickedToggle)
            if isOn then
                for _, child in ipairs(teleportPage:GetChildren()) do
                    if child:IsA("TextButton") and child ~= clickedToggle then
                        local otherSlider = child:FindFirstChild("Frame")
                        if otherSlider then
                            local otherKnob = otherSlider:FindFirstChild("Frame")
                            if otherKnob then
                                TweenService:Create(otherSlider, TweenInfo.new(0.18), {BackgroundColor3 = Color3.fromRGB(90, 90, 110)}):Play()
                                TweenService:Create(otherKnob, TweenInfo.new(0.18), {Position = UDim2.new(0, 1, 0.5, -3)}):Play()
                            end
                        end
                    end
                end
                activeIsland = island
                teleportAndFace()
            end
        end)
    end

    task.wait()
    featuresPage.CanvasSize = UDim2.new(0, 0, 0, fLayout.AbsoluteContentSize.Y + 10)
    teleportPage.CanvasSize = UDim2.new(0, 0, 0, tLayout.AbsoluteContentSize.Y + 10)

    fLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        featuresPage.CanvasSize = UDim2.new(0, 0, 0, fLayout.AbsoluteContentSize.Y + 10)
    end)
    tLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        teleportPage.CanvasSize = UDim2.new(0, 0, 0, tLayout.AbsoluteContentSize.Y + 10)
    end)

    local titleLabel = Instance.new("TextLabel", mainFrame)
    titleLabel.Size = UDim2.new(1, -20, 0, 13)
    titleLabel.Position = UDim2.new(0, 8, 0, 2)
    titleLabel.Text = "ðŸ¦‹ Laudyaaa"
    titleLabel.TextColor3 = Color3.fromRGB(180, 190, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 9
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left

    closeBtn = Instance.new("TextButton", mainFrame)
    closeBtn.Size = UDim2.new(0, 10, 0, 10)
    closeBtn.Position = UDim2.new(1, -15, 0, 2)
    closeBtn.Text = "âœ•"
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 8
    closeBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    closeBtn.TextColor3 = Color3.fromRGB(220, 220, 230)
    closeBtn.ZIndex = 999
    closeBtn.Active = true
    Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 3)
    closeBtn.MouseButton1Click:Connect(function() mainFrame.Visible = false end)
    closeBtn.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            mainFrame.Visible = false
        end
    end)

    local logoBtn = Instance.new("TextButton", gui)
    logoBtn.Size = UDim2.new(0, 13, 0, 13)
    logoBtn.Position = UDim2.new(0, 4, 0.8, 0)
    logoBtn.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
    logoBtn.Text = "ðŸ¦‹"
    logoBtn.TextSize = 8
    Instance.new("UICorner", logoBtn).CornerRadius = UDim.new(0, 4)
    logoBtn.Visible = false
    logoBtn.MouseButton1Click:Connect(function() mainFrame.Visible = true end)
    mainFrame:GetPropertyChangedSignal("Visible"):Connect(function() logoBtn.Visible = not mainFrame.Visible end)

    local function makeDraggable(frame)
        local dragging, dragStart, startPos = false, nil, nil
        frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = frame.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then dragging = false end
                end)
            end
        end)
        UserInputService.InputChanged:Connect(function(input)
            if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                local delta = input.Position - dragStart
                frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
    end
    makeDraggable(mainFrame)
    makeDraggable(logoBtn)
    showPage(infoPage)
end

player.CharacterAdded:Connect(function()
    task.wait(2)
    if autoFishWasOn then enableAutoFish() end
    if autoSellWasOn then autoSellRunning = true; autoSellLoop() end
    if autoClickerWasOn then autoClickerRunning = true; autoClickerLoop() end
    if fpsBoostWasOn then enableFPSBoost() end
    if activeIsland then teleportAndFace() end
end)

buildUI()
