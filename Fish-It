
local player = game.Players.LocalPlayer
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local Lighting = game:GetService("Lighting")
local replicatedStorage = game:GetService("ReplicatedStorage")

local autoSellRunning = false
local autoClickerRunning = false
local fpsBoostEnabled = false
local clickerDelay = 0.05
local activeIsland = nil
local clickPosition = nil
local settingClickPosition = false
local fishCount = 0
local autoSellThreshold = 500

local autoFishWasOn = false
local autoSellWasOn = false
local autoClickerWasOn = false
local fpsBoostWasOn = false

local gui
local clickIndicator
local autoClickerToggle
local closeBtn
local allGuiElements = {}
local protectedElements = {}
local originalLightingSettings = {}

local toggleRefs = {}
local configPath = "LaudyaaaConfig_" .. player.UserId .. ".json"

local islands = {
    { Name = "Esoteric Depths", Position = Vector3.new(3207.41, -1302.86, 1444.84), LookAt = Vector3.new(3250.56, -1302.86, 1419.57) },
    { Name = "Treasure Room", Position = Vector3.new(-3611.89, -279.07, -1589.51), LookAt = Vector3.new(-3619.21, -286.53, -1602.57) },
    { Name = "Lost Isle", Position = Vector3.new(-3738.2, -135.1, -1011.9), LookAt = Vector3.new(-3600, -135, -1200) },
}

local teleportToggles = {}

task.spawn(function()
    pcall(function()
        local loc = game:GetService("LocalizationService")
        loc.RobloxForcePlayModeRobloxLocaleId = "en-us"
        loc.RobloxForcePlayModeGameLocaleId = "en-us"
    end)
end)

local function forceEnglish(instance)
    for _, obj in ipairs(instance:GetDescendants()) do
        if obj:IsA("TextLabel") or obj:IsA("TextButton") or obj:IsA("TextBox") then
            pcall(function()
                obj.AutoLocalize = false
            end)
        end
    end
end

local cachedRemotes = {}
local function getRemote(path)
    if cachedRemotes[path] then return cachedRemotes[path] end
    
    local remote = replicatedStorage:FindFirstChild("Packages")
    if not remote then return nil end
    
    remote = remote:FindFirstChild("_Index")
    if not remote then return nil end
    
    remote = remote:FindFirstChild("sleitnick_net@0.2.0")
    if not remote then return nil end
    
    remote = remote:FindFirstChild("net")
    if not remote then return nil end
    
    if path == "autofish" then
        remote = remote:FindFirstChild("RF/UpdateAutoFishingState")
    end
    
    cachedRemotes[path] = remote
    return remote
end

local saveWait = false
local function saveSettings()
    if not writefile then return end
    if saveWait then return end
    
    saveWait = true
    task.delay(0.5, function()
        local data = {
            autoFish = autoFishWasOn,
            autoSell = autoSellWasOn,
            autoClicker = autoClickerWasOn,
            fpsBoost = fpsBoostWasOn,
            clickDelay = clickerDelay > 0 and math.floor(1/clickerDelay) or 20,
            teleportIndex = nil,
            clickPos = clickPosition and {X = clickPosition.X, Y = clickPosition.Y} or nil
        }
        
        if activeIsland then
            for i, v in ipairs(islands) do
                if v == activeIsland then
                    data.teleportIndex = i
                    break
                end
            end
        end
        
        pcall(function()
            writefile(configPath, HttpService:JSONEncode(data))
        end)
        saveWait = false
    end)
end

local function loadSettings()
    if not (readfile and isfile and isfile(configPath)) then return end
    
    local ok, content = pcall(readfile, configPath)
    if not ok or not content then return end
    
    local success, decoded = pcall(function()
        return HttpService:JSONDecode(content)
    end)
    
    if success and type(decoded) == "table" then
        autoFishWasOn = decoded.autoFish or false
        autoSellWasOn = decoded.autoSell or false
        autoClickerWasOn = decoded.autoClicker or false
        fpsBoostWasOn = decoded.fpsBoost or false
        clickerDelay = (decoded.clickDelay and decoded.clickDelay > 0) and (1 / decoded.clickDelay) or 0.05
        
        if decoded.teleportIndex and islands[decoded.teleportIndex] then
            activeIsland = islands[decoded.teleportIndex]
        end
        
        if decoded.clickPos then
            clickPosition = Vector2.new(decoded.clickPos.X, decoded.clickPos.Y)
        end
    end
end

loadSettings()

local function getFishCount()
    local root = game.Players.LocalPlayer:FindFirstChild("PlayerGui")
    if not root then return 0 end

    for _, gui in ipairs(root:GetChildren()) do
        if gui:IsA("ScreenGui") then
            for _, child in ipairs(gui:GetDescendants()) do
                if child:IsA("TextLabel") and child.Name == "BagSize" and child.Visible then
                    local match = child.Text:match("([%d,]+)%s*/")
                    if match then
                        match = match:gsub(",", ""):gsub("%s+", "")
                        return tonumber(match)
                    end
                end
            end
        end
    end
    return 0
end

local function sellAllFish()
    pcall(function()
        local pkg = replicatedStorage:FindFirstChild("Packages")
        if not pkg then return end

        local idx = pkg:FindFirstChild("_Index")
        if not idx then return end

        local sleitnick = idx:FindFirstChild("sleitnick_net@0.2.0")
        if not sleitnick then return end

        local netFolder = sleitnick:FindFirstChild("net")
        if not netFolder then return end

        for _, obj in ipairs(netFolder:GetDescendants()) do
            if (obj:IsA("RemoteFunction") or obj:IsA("RemoteEvent")) then
                local nameLower = obj.Name:lower()
                if nameLower:find("sell") or (nameLower:find("rf/") and nameLower:find("sell")) then
                    pcall(function()
                        if obj:IsA("RemoteFunction") then
                            obj:InvokeServer()
                        else
                            obj:FireServer()
                        end
                    end)
                end
            end
        end

        local function tryInvokeByName(n)
            local candidate = netFolder:FindFirstChild(n)
            if candidate then
                pcall(function()
                    if candidate:IsA("RemoteFunction") then
                        candidate:InvokeServer()
                    elseif candidate:IsA("RemoteEvent") then
                        candidate:FireServer()
                    end
                end)
            end
        end

        tryInvokeByName("RF/SellAllItems")
        tryInvokeByName("SellAllItems")
        tryInvokeByName("RF/SellItem")
        tryInvokeByName("SellItem")
    end)
end

local function autoSellLoop()
    task.spawn(function()
        while autoSellRunning do
            task.wait(15)
            if getFishCount() >= autoSellThreshold then
                sellAllFish()
                task.wait(2)
            end
        end
    end)
end

local function debugMsg(msg)
    local gui = Instance.new("ScreenGui")
    gui.Name = "DebugMsgPop"
    gui.Parent = game.Players.LocalPlayer.PlayerGui
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 0, 32)
    label.Position = UDim2.new(0, 0, 0, 0)
    label.BackgroundColor3 = Color3.fromRGB(22, 22, 44)
    label.TextColor3 = Color3.fromRGB(255, 255, 100)
    label.Text = tostring(msg)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 17
    label.BackgroundTransparency = 0.17
    label.Parent = gui
    game:GetService("Debris"):AddItem(gui, 1.6)
end

local function enableAutoFish()
    task.spawn(function()
        if not autoFishWasOn then return end
        
        local char = player.Character
        if not char then return end
        
        task.wait(1)
        local hasRod = char:FindFirstChild("!!!FISHING_VIEW_MODEL!!!")
        task.wait(1)

        if hasRod then
            local VIM = game:GetService("VirtualInputManager")
            VIM:SendKeyEvent(true, Enum.KeyCode.One, false, game)
            task.wait(0.05)
            VIM:SendKeyEvent(false, Enum.KeyCode.One, false, game)
            task.wait(0.8)
        end
        
        if not autoFishWasOn then return end
        
        task.wait(1)
        
        local remote = getRemote("autofish")
        if remote and remote:IsA("RemoteFunction") then
            pcall(function()
                remote:InvokeServer(true)
            end)
        end
    end)
end

local function enableFPSBoost()
    originalLightingSettings = {
        Brightness = Lighting.Brightness,
        GlobalShadows = Lighting.GlobalShadows,
        Technology = Lighting.Technology,
        Ambient = Lighting.Ambient,
        OutdoorAmbient = Lighting.OutdoorAmbient,
    }
    
    settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
    settings().Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Level01
    UserSettings():GetService("UserGameSettings").SavedQualityLevel = Enum.SavedQualitySetting.QualityLevel1
    
    Lighting.GlobalShadows = false
    Lighting.Brightness = 3
    Lighting.Technology = Enum.Technology.Compatibility
    Lighting.Ambient = Color3.fromRGB(255, 255, 255)
    Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)
    Lighting.FogEnd = 50
    Lighting.FogStart = 0
    
    for _, effect in ipairs(Lighting:GetChildren()) do
        pcall(function() effect:Destroy() end)
    end
    
    pcall(function()
        workspace.Terrain.WaterTransparency = 1
        workspace.Terrain.WaterReflectance = 0
        workspace.Terrain.WaterWaveSize = 0
        workspace.Terrain.WaterWaveSpeed = 0
        workspace.Terrain.Decoration = false
    end)
    
    local function destroyMeshes(parent)
        for _, obj in pairs(parent:GetDescendants()) do
            pcall(function()
                if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or 
                   obj:IsA("Fire") or obj:IsA("Sparkles") or obj:IsA("Explosion") or
                   obj:IsA("PointLight") or obj:IsA("SpotLight") or obj:IsA("SurfaceLight") or
                   obj:IsA("Decal") or obj:IsA("Texture") or obj:IsA("SurfaceAppearance") then
                    obj:Destroy()
                end
                
                if obj:IsA("SpecialMesh") or obj:IsA("FileMesh") or obj:IsA("CylinderMesh") or 
                   obj:IsA("BlockMesh") or obj:IsA("Accessory") or obj:IsA("Hat") then
                    obj:Destroy()
                end
                
                if obj:IsA("BasePart") then
                    obj.Material = Enum.Material.SmoothPlastic
                    obj.CastShadow = false
                    obj.Reflectance = 0
                end
                
                if obj:IsA("Shirt") or obj:IsA("Pants") or obj:IsA("ShirtGraphic") then
                    obj:Destroy()
                end
                
                if obj:IsA("HumanoidDescription") then
                    obj.HeadColor = Color3.fromRGB(255, 255, 255)
                    obj.TorsoColor = Color3.fromRGB(200, 200, 200)
                    obj.LeftArmColor = Color3.fromRGB(200, 200, 200)
                    obj.RightArmColor = Color3.fromRGB(200, 200, 200)
                    obj.LeftLegColor = Color3.fromRGB(100, 100, 100)
                    obj.RightLegColor = Color3.fromRGB(100, 100, 100)
                    obj.Head = 0
                    obj.Face = 0
                end
            end)
        end
    end
    
    task.spawn(function()
        destroyMeshes(workspace)
    end)
    
    for _, plr in pairs(game.Players:GetPlayers()) do
        if plr.Character then
            task.spawn(function()
                destroyMeshes(plr.Character)
                
                for _, obj in pairs(plr.Character:GetDescendants()) do
                    if obj:IsA("BodyColors") then
                        obj.HeadColor3 = Color3.fromRGB(255, 255, 255)
                        obj.TorsoColor3 = Color3.fromRGB(200, 200, 200)
                        obj.LeftArmColor3 = Color3.fromRGB(200, 200, 200)
                        obj.RightArmColor3 = Color3.fromRGB(200, 200, 200)
                        obj.LeftLegColor3 = Color3.fromRGB(100, 100, 100)
                        obj.RightLegColor3 = Color3.fromRGB(100, 100, 100)
                    end
                end
            end)
        end
    end
    
    game.Players.PlayerAdded:Connect(function(plr)
        if not fpsBoostEnabled then return end
        plr.CharacterAdded:Connect(function(char)
            task.wait(0.1)
            destroyMeshes(char)
        end)
    end)
    
    workspace.DescendantAdded:Connect(function(obj)
        if not fpsBoostEnabled then return end
        pcall(function()
            if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or 
               obj:IsA("Fire") or obj:IsA("Sparkles") or obj:IsA("PointLight") or 
               obj:IsA("SpotLight") or obj:IsA("SurfaceLight") or obj:IsA("Decal") or 
               obj:IsA("Texture") or obj:IsA("SpecialMesh") or obj:IsA("Accessory") then
                obj:Destroy()
            elseif obj:IsA("BasePart") then
                obj.Material = Enum.Material.SmoothPlastic
                obj.CastShadow = false
                obj.Reflectance = 0
            end
        end)
    end)
    
    task.spawn(function()
        task.wait(1)
        if player.Character then
            destroyMeshes(player.Character)
        end
    end)
end

local function disableFPSBoost()
    if originalLightingSettings.Brightness then
        Lighting.Brightness = originalLightingSettings.Brightness
        Lighting.GlobalShadows = originalLightingSettings.GlobalShadows
        Lighting.Technology = originalLightingSettings.Technology or Enum.Technology.ShadowMap
    end
    
    settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
    
    for _, effect in ipairs(Lighting:GetChildren()) do
        if effect:IsA("PostEffect") then
            effect.Enabled = true
        end
    end
    
    pcall(function()
        workspace.Terrain.WaterTransparency = 0.3
        workspace.Terrain.WaterReflectance = 1
    end)
end

local function teleportAndFace()
    local char = player.Character
    if not (char and char:FindFirstChild("HumanoidRootPart") and activeIsland) then return end
    
    local hrp = char.HumanoidRootPart
    hrp.CFrame = CFrame.new(activeIsland.Position + Vector3.new(0, 5, 0))
    task.wait(0.2)
    
    hrp.CFrame = CFrame.lookAt(hrp.Position, activeIsland.LookAt)
end

local function isMouseOverGui()
    if not gui then return false end
    local mousePos = UserInputService:GetMouseLocation()
    local guiObjects = player.PlayerGui:GetGuiObjectsAtPosition(mousePos.X, mousePos.Y)
    for _, obj in ipairs(guiObjects) do
        if obj:IsDescendantOf(gui) then
            return true
        end
    end
    return false
end

local function setGuiInteractable(enabled)
    for _, element in ipairs(allGuiElements) do
        if element and element.Parent then
            local isProtected = false
            for _, protected in ipairs(protectedElements) do
                if element == protected then
                    isProtected = true
                    break
                end
            end
            if not isProtected and element:GetAttribute("OriginalTransparency") then
                element.BackgroundTransparency = enabled and element:GetAttribute("OriginalTransparency") or 0.7
            end
        end
    end
end

local function stopAutoClicker()
    autoClickerRunning = false
    autoClickerWasOn = false
    saveSettings()
    setGuiInteractable(true)
    
    if not settingClickPosition then
        clickIndicator.Visible = false
    end
    
    if autoClickerToggle then
        local sliderBg = autoClickerToggle:FindFirstChild("Frame")
        local knob = sliderBg and sliderBg:FindFirstChild("Frame")
        if sliderBg and knob then
            TweenService:Create(sliderBg, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(100, 100, 115)}):Play()
            TweenService:Create(knob, TweenInfo.new(0.15), {Position = UDim2.new(0, 3, 0.5, -3)}):Play()
        end
    end
end

local function autoClickerLoop()
    task.spawn(function()
        while autoClickerRunning do
            if not autoClickerRunning then break end
            
            pcall(function()
                if clickPosition and closeBtn then
                    local closePos = closeBtn.AbsolutePosition
                    local closeSize = closeBtn.AbsoluteSize
                    local shouldClick = not (
                        clickPosition.X >= closePos.X and 
                        clickPosition.X <= closePos.X + closeSize.X and
                        clickPosition.Y >= closePos.Y and 
                        clickPosition.Y <= closePos.Y + closeSize.Y
                    )
                    if shouldClick then
                        local VIM = game:GetService("VirtualInputManager")
                        VIM:SendMouseButtonEvent(clickPosition.X, clickPosition.Y, 0, true, game, 0)
                        task.wait(0.01)
                        VIM:SendMouseButtonEvent(clickPosition.X, clickPosition.Y, 0, false, game, 0)
                    end
                elseif not isMouseOverGui() then
                    mouse1click()
                end
            end)
            task.wait(clickerDelay)
        end
    end)
end

UserInputService.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton2 and autoClickerRunning then
        stopAutoClicker()
    end
end)

local function createCategoryHeader(parent, text, posY)
    local header = Instance.new("TextLabel", parent)
    header.Size = UDim2.new(1, -20, 0, 18)
    header.Position = UDim2.new(0, 10, 0, posY)
    header.Text = text
    header.TextColor3 = Color3.fromRGB(180, 190, 255)
    header.Font = Enum.Font.GothamBold
    header.TextSize = 9
    header.BackgroundTransparency = 1
    header.TextXAlignment = Enum.TextXAlignment.Left
    header.AutoLocalize = false
    return header
end

local function createModernToggle(parent, labelText, posY, onToggleCallback)
    local toggleWidth, toggleHeight = 24, 12
    local holder = Instance.new("TextButton", parent)
    holder.Size = UDim2.new(1, -15, 0, 22)
    holder.Position = UDim2.new(0, 10, 0, posY)
    holder.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    holder.BackgroundTransparency = 0.3
    holder.BorderSizePixel = 0
    holder.Text = ""
    holder.AutoButtonColor = false
    holder:SetAttribute("OriginalTransparency", 0.3)
    Instance.new("UICorner", holder).CornerRadius = UDim.new(0, 5)
    
    local stroke = Instance.new("UIStroke", holder)
    stroke.Color = Color3.fromRGB(70, 70, 85)
    stroke.Thickness = 1
    stroke.Transparency = 0.4
    
    local label = Instance.new("TextLabel", holder)
    label.Size = UDim2.new(1, -toggleWidth-15, 1, 0)
    label.Position = UDim2.new(0, 6, 0, 0)
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(220, 220, 230)
    label.Font = Enum.Font.Gotham
    label.TextSize = 6
    label.BackgroundTransparency = 1
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextYAlignment = Enum.TextYAlignment.Center
    label.TextWrapped = false
    label.AutoLocalize = false
    
    local sliderBg = Instance.new("Frame", holder)
    sliderBg.Size = UDim2.new(0, toggleWidth, 0, toggleHeight)
    sliderBg.Position = UDim2.new(1, -toggleWidth-8, 0.5, -toggleHeight/2)
    sliderBg.BackgroundColor3 = Color3.fromRGB(100, 100, 115)
    sliderBg.BorderSizePixel = 0
    sliderBg.ZIndex = 2
    Instance.new("UICorner", sliderBg).CornerRadius = UDim.new(1, 0)
    
    local knob = Instance.new("Frame", sliderBg)
    knob.Size = UDim2.new(0, toggleHeight-6, 0, toggleHeight-6)
    knob.Position = UDim2.new(0, 3, 0.5, -(toggleHeight-6)/2)
    knob.BackgroundColor3 = Color3.fromRGB(240, 240, 245)
    knob.BorderSizePixel = 0
    knob.ZIndex = 3
    Instance.new("UICorner", knob).CornerRadius = UDim.new(1, 0)
    
    local isOn = false
    local function setVisual(state)
        if state then
            TweenService:Create(sliderBg, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(88, 101, 242)}):Play()
            TweenService:Create(knob, TweenInfo.new(0.15), {Position = UDim2.new(1, -(toggleHeight-3), 0.5, -(toggleHeight-6)/2)}):Play()
        else
            TweenService:Create(sliderBg, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(100, 100, 115)}):Play()
            TweenService:Create(knob, TweenInfo.new(0.15), {Position = UDim2.new(0, 3, 0.5, -(toggleHeight-6)/2)}):Play()
        end
    end
    
    local function setState(state, triggerCallback)
        isOn = state
        setVisual(state)
        if triggerCallback and onToggleCallback then 
            onToggleCallback(state, holder) 
        end
    end
    
    holder.MouseButton1Click:Connect(function()
        isOn = not isOn
        setVisual(isOn)
        if onToggleCallback then onToggleCallback(isOn, holder) end
    end)
    
    setVisual(false)
    table.insert(allGuiElements, holder)
    return holder, setState
end

local function createButton(parent, labelText, posY, onClickCallback)
    local holder = Instance.new("TextButton", parent)
    holder.Size = UDim2.new(1, -20, 0, 28)
    holder.Position = UDim2.new(0, 10, 0, posY)
    holder.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    holder.BackgroundTransparency = 0.2
    holder.BorderSizePixel = 0
    holder.Text = labelText
    holder.TextColor3 = Color3.fromRGB(255, 255, 255)
    holder.Font = Enum.Font.GothamBold
    holder.TextSize = 6
    holder.AutoButtonColor = false
    holder.AutoLocalize = false
    holder:SetAttribute("OriginalTransparency", 0.2)
    Instance.new("UICorner", holder).CornerRadius = UDim.new(0, 5)
    
    holder.MouseButton1Click:Connect(function()
        if onClickCallback then onClickCallback() end
    end)
    
    holder.MouseEnter:Connect(function()
        TweenService:Create(holder, TweenInfo.new(0.15), {BackgroundTransparency = 0}):Play()
    end)
    
    holder.MouseLeave:Connect(function()
        TweenService:Create(holder, TweenInfo.new(0.15), {BackgroundTransparency = 0.2}):Play()
    end)
    
    table.insert(allGuiElements, holder)
    return holder
end

local function createSlider(parent, labelText, posY, minVal, maxVal, defaultVal, onValueChanged)
    local holder = Instance.new("Frame", parent)
    holder.Size = UDim2.new(1, -20, 0, 28)
    holder.Position = UDim2.new(0, 10, 0, posY)
    holder.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    holder.BackgroundTransparency = 0.3
    holder.BorderSizePixel = 0
    Instance.new("UICorner", holder).CornerRadius = UDim.new(0, 5)
    
    local stroke = Instance.new("UIStroke", holder)
    stroke.Color = Color3.fromRGB(70, 70, 85)
    stroke.Thickness = 1
    stroke.Transparency = 0.4
    
    local label = Instance.new("TextLabel", holder)
    label.Size = UDim2.new(1, -45, 0, 16)
    label.Position = UDim2.new(0, 6, 0, 3)
    label.Text = labelText
    label.TextColor3 = Color3.fromRGB(220, 220, 230)
    label.Font = Enum.Font.Gotham
    label.TextSize = 8
    label.BackgroundTransparency = 1
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.AutoLocalize = false
    
    local valueLabel = Instance.new("TextLabel", holder)
    valueLabel.Size = UDim2.new(0, 40, 0, 16)
    valueLabel.Position = UDim2.new(1, -45, 0, 3)
    valueLabel.Text = tostring(defaultVal) .. " CPS"
    valueLabel.TextColor3 = Color3.fromRGB(180, 190, 255)
    valueLabel.Font = Enum.Font.GothamBold
    valueLabel.TextSize = 6
    valueLabel.BackgroundTransparency = 1
    valueLabel.AutoLocalize = false
    
    local sliderFrame = Instance.new("Frame", holder)
    sliderFrame.Size = UDim2.new(1, -16, 0, 6)
    sliderFrame.Position = UDim2.new(0, 8, 0, 25)
    sliderFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 75)
    sliderFrame.BorderSizePixel = 0
    Instance.new("UICorner", sliderFrame).CornerRadius = UDim.new(1, 0)
    
    local sliderFill = Instance.new("Frame", sliderFrame)
    sliderFill.Size = UDim2.new((defaultVal - minVal) / (maxVal - minVal), 0, 1, 0)
    sliderFill.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    sliderFill.BorderSizePixel = 0
    Instance.new("UICorner", sliderFill).CornerRadius = UDim.new(1, 0)
    
    local sliderButton = Instance.new("TextButton", sliderFrame)
    sliderButton.Size = UDim2.new(0, 10, 0, 10)
    sliderButton.Position = UDim2.new((defaultVal - minVal) / (maxVal - minVal), -5, 0.5, -5)
    sliderButton.BackgroundColor3 = Color3.fromRGB(240, 240, 245)
    sliderButton.Text = ""
    sliderButton.BorderSizePixel = 0
    Instance.new("UICorner", sliderButton).CornerRadius = UDim.new(1, 0)
    
    local dragging = false
    
    local function updateSlider(pos)
        local sliderPos = sliderFrame.AbsolutePosition.X
        local sliderSize = sliderFrame.AbsoluteSize.X
        local percentage = math.clamp((pos - sliderPos) / sliderSize, 0, 1)
        local value = math.floor(minVal + (maxVal - minVal) * percentage)
        sliderButton.Position = UDim2.new(percentage, -5, 0.5, -5)
        sliderFill.Size = UDim2.new(percentage, 0, 1, 0)
        valueLabel.Text = tostring(value) .. " CPS"
        if onValueChanged then onValueChanged(value) end
    end
    
    sliderButton.MouseButton1Down:Connect(function() dragging = true end)
    
    sliderButton.TouchPan:Connect(function(touchPositions, totalTranslation, velocity, userInputState)
        if userInputState == Enum.UserInputState.Change and touchPositions[1] then
            dragging = true
            updateSlider(touchPositions[1].X)
        elseif userInputState == Enum.UserInputState.End then
            dragging = false
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging then
            local pos
            if input.UserInputType == Enum.UserInputType.MouseMovement then
                pos = UserInputService:GetMouseLocation().X
            elseif input.UserInputType == Enum.UserInputType.Touch then
                pos = input.Position.X
            end
            if pos then updateSlider(pos) end
        end
    end)
    
    table.insert(allGuiElements, sliderButton)
    return holder
end

local function buildUI()
    if gui then return end
    
    local blur = Instance.new("BlurEffect")
    blur.Size = 12
    blur.Parent = Lighting

    gui = Instance.new("ScreenGui")
    gui.Name = "FishItGlassHub"
    gui.ResetOnSpawn = false
    gui.Parent = player.PlayerGui

    clickIndicator = Instance.new("TextButton", gui)
    clickIndicator.Size = UDim2.new(0, 50, 0, 50)
    clickIndicator.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    clickIndicator.BackgroundTransparency = 0.4
    clickIndicator.BorderSizePixel = 0
    clickIndicator.Visible = false
    clickIndicator.ZIndex = 10
    clickIndicator.Text = ""
    clickIndicator.AutoButtonColor = false
    Instance.new("UICorner", clickIndicator).CornerRadius = UDim.new(1, 0)
    
    local innerCircle = Instance.new("Frame", clickIndicator)
    innerCircle.Size = UDim2.new(0, 6, 0, 6)
    innerCircle.Position = UDim2.new(0.5, -3, 0.5, -3)
    innerCircle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    innerCircle.BorderSizePixel = 0
    Instance.new("UICorner", innerCircle).CornerRadius = UDim.new(1, 0)
    
    local stopLabel = Instance.new("TextLabel", clickIndicator)
    stopLabel.Size = UDim2.new(1, 0, 0, 14)
    stopLabel.Position = UDim2.new(0, 0, 1, 3)
    stopLabel.Text = "TAP TO STOP"
    stopLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    stopLabel.Font = Enum.Font.GothamBold
    stopLabel.TextSize = 7
    stopLabel.BackgroundTransparency = 1
    stopLabel.AutoLocalize = false
    
    clickIndicator.MouseButton1Click:Connect(function()
        if autoClickerRunning then stopAutoClicker() end
    end)

    local mainFrame = Instance.new("Frame", gui)
    mainFrame.Size = UDim2.new(0, 160, 0, 150)
    mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
    mainFrame.BorderSizePixel = 0
    Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 6)
    
    local mainStroke = Instance.new("UIStroke", mainFrame)
    mainStroke.Color = Color3.fromRGB(60, 60, 75)
    mainStroke.Thickness = 1

    local titleLabel = Instance.new("TextLabel", mainFrame)
    titleLabel.Size = UDim2.new(0, 150, 0, 24)
    titleLabel.Position = UDim2.new(0, 8, 0, 5)
    titleLabel.Text = "ðŸ¦‹ Laudyaaa"
    titleLabel.TextColor3 = Color3.fromRGB(180, 190, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 10
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.AutoLocalize = false

    closeBtn = Instance.new("TextButton", mainFrame)
    closeBtn.Size = UDim2.new(0, 20, 0, 20)
    closeBtn.Position = UDim2.new(1, -26, 0, 8)
    closeBtn.Text = "âœ•"
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 12
    closeBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    closeBtn.TextColor3 = Color3.fromRGB(200, 200, 210)
    closeBtn.ZIndex = 999
    closeBtn.Active = true
    Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 4)
    
    closeBtn.MouseButton1Click:Connect(function() mainFrame.Visible = false end)
    closeBtn.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            mainFrame.Visible = false
        end
    end)
    
    table.insert(protectedElements, closeBtn)

    local sidebar = Instance.new("Frame", mainFrame)
    sidebar.Size = UDim2.new(0, 65, 1, -38)
    sidebar.Position = UDim2.new(0, 5, 0, 33)
    sidebar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    sidebar.BackgroundTransparency = 0.3
    sidebar.BorderSizePixel = 0
    Instance.new("UICorner", sidebar).CornerRadius = UDim.new(0, 5)

    local function createTabButton(text, yPos)
        local btn = Instance.new("TextButton", sidebar)
        btn.Size = UDim2.new(1, -5, 0, 24)
        btn.Position = UDim2.new(0, 2.5, 0, yPos)
        btn.BackgroundTransparency = 1
        btn.Text = text
        btn.TextColor3 = Color3.fromRGB(200, 210, 230)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 8
        btn.AutoButtonColor = false
        btn.TextXAlignment = Enum.TextXAlignment.Left
        btn.AutoLocalize = false
        btn.MouseEnter:Connect(function() btn.TextColor3 = Color3.fromRGB(255, 255, 255) end)
        btn.MouseLeave:Connect(function() btn.TextColor3 = Color3.fromRGB(200, 210, 230) end)
        table.insert(protectedElements, btn)
        return btn
    end

    local infoBtn = createTabButton("Information", 5)
    local featuresBtn = createTabButton("Features", 34)
    local teleportBtn = createTabButton("Teleport", 63)

    local contentContainer = Instance.new("Frame", mainFrame)
    contentContainer.Size = UDim2.new(1, -78, 1, -40)
    contentContainer.Position = UDim2.new(0, 73, 0, 35)
    contentContainer.BackgroundTransparency = 1
    contentContainer.BorderSizePixel = 0

    local infoPage = Instance.new("Frame", contentContainer)
    infoPage.Name = "InfoPage"
    infoPage.Size = UDim2.new(1, 0, 1, 0)
    infoPage.BackgroundTransparency = 1
    infoPage.Visible = true

    local infoText = Instance.new("TextLabel", infoPage)
    infoText.Size = UDim2.new(1, -10, 1, -10)
    infoText.Position = UDim2.new(0, 5, 0, 5)
    infoText.BackgroundTransparency = 1
    infoText.TextWrapped = true
    infoText.TextColor3 = Color3.fromRGB(220, 220, 240)
    infoText.Font = Enum.Font.GothamBold
    infoText.TextSize = 8
    infoText.Text = "Script developed by Einhard and made with luv"
    infoText.TextXAlignment = Enum.TextXAlignment.Center
    infoText.TextYAlignment = Enum.TextYAlignment.Center
    infoText.AutoLocalize = false

    local featuresPage = Instance.new("ScrollingFrame", contentContainer)
    featuresPage.Name = "FeaturesPage"
    featuresPage.Size = UDim2.new(1, 0, 1, 0)
    featuresPage.BackgroundTransparency = 1
    featuresPage.BorderSizePixel = 0
    featuresPage.ScrollBarThickness = 2
    featuresPage.CanvasSize = UDim2.new(0, 0, 0, 300)
    featuresPage.Visible = false

    local teleportPage = Instance.new("ScrollingFrame", contentContainer)
    teleportPage.Name = "TeleportPage"
    teleportPage.Size = UDim2.new(1, 0, 1, 0)
    teleportPage.BackgroundTransparency = 1
    teleportPage.BorderSizePixel = 0
    teleportPage.ScrollBarThickness = 2
    teleportPage.CanvasSize = UDim2.new(0, 0, 0, 170)
    teleportPage.Visible = false

    local function showPage(page)
        infoPage.Visible = false
        featuresPage.Visible = false
        teleportPage.Visible = false
        page.Visible = true
    end

    infoBtn.MouseButton1Click:Connect(function() showPage(infoPage) end)
    featuresBtn.MouseButton1Click:Connect(function() showPage(featuresPage) end)
    teleportBtn.MouseButton1Click:Connect(function() showPage(teleportPage) end)

    createCategoryHeader(featuresPage, "FISHING", 5)
    local _, setAutoFish = createModernToggle(featuresPage, "Auto Fish", 25, function(isOn)
        autoFishWasOn = isOn
        saveSettings()
        
        if isOn then 
            enableAutoFish()
        else
            task.spawn(function()
                local remote = getRemote("autofish")
                if remote and remote:IsA("RemoteFunction") then
                    pcall(function()
                        remote:InvokeServer(false)
                    end)
                end
            end)
        end
    end)
    toggleRefs.autoFish = setAutoFish

    local _, setAutoSell = createModernToggle(featuresPage, "Auto Sell (500+ fish)", 57, function(isOn)
        autoSellWasOn = isOn
        autoSellRunning = isOn
        saveSettings()
        if isOn then autoSellLoop() end
    end)
    toggleRefs.autoSell = setAutoSell

    createCategoryHeader(featuresPage, "AUTO CLICKER", 95)
    createSlider(featuresPage, "Click Speed", 115, 1, 50, math.floor(1/clickerDelay), function(value)
        clickerDelay = 1 / value
        saveSettings()
    end)
    
    createButton(featuresPage, "Set Position", 162, function()
        settingClickPosition = true
        clickIndicator.Visible = true
        local connection
        connection = UserInputService.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                local mousePos = UserInputService:GetMouseLocation()
                clickPosition = Vector2.new(mousePos.X, mousePos.Y)
                clickIndicator.Position = UDim2.new(0, mousePos.X - 25, 0, mousePos.Y - 25)
                settingClickPosition = false
                saveSettings()
                connection:Disconnect()
            end
        end)
    end)
    
    autoClickerToggle, toggleRefs.autoClicker = createModernToggle(featuresPage, "Auto Clicker", 195, function(isOn)
        autoClickerWasOn = isOn
        autoClickerRunning = isOn
        saveSettings()
        
        if isOn then 
            autoClickerLoop()
            if clickPosition then 
                clickIndicator.Visible = true 
                clickIndicator.Position = UDim2.new(0, clickPosition.X - 25, 0, clickPosition.Y - 25)
            end
        else
            stopAutoClicker()
        end
    end)
    table.insert(protectedElements, autoClickerToggle)

    createCategoryHeader(featuresPage, "PERFORMANCE", 233)
    local _, setFPSBoost = createModernToggle(featuresPage, "FPS Boost", 253, function(isOn)
        fpsBoostWasOn = isOn
        fpsBoostEnabled = isOn
        saveSettings()
        if isOn then enableFPSBoost() else disableFPSBoost() end
    end)
    toggleRefs.fpsBoost = setFPSBoost

    local startY = 10
    for i, island in ipairs(islands) do
        local toggle, setTeleportState = createModernToggle(teleportPage, island.Name, startY + (i-1)*30, function(isOn, clickedToggle)
            if isOn then
                for _, child in ipairs(teleportPage:GetChildren()) do
                    if child:IsA("TextButton") and child ~= clickedToggle then
                        local otherSlider = child:FindFirstChild("Frame")
                        if otherSlider then
                            local otherKnob = otherSlider:FindFirstChild("Frame")
                            if otherKnob then
                                TweenService:Create(otherSlider, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(100, 100, 115)}):Play()
                                TweenService:Create(otherKnob, TweenInfo.new(0.15), {Position = UDim2.new(0, 3, 0.5, -3)}):Play()
                            end
                        end
                    end
                end
                activeIsland = island
                saveSettings()
                teleportAndFace()
            else
                if activeIsland == island then
                    activeIsland = nil
                    saveSettings()
                end
            end
        end)
        
        teleportToggles[i] = {toggle = toggle, setState = setTeleportState}
    end

    local logoBtn = Instance.new("TextButton", gui)
    logoBtn.Size = UDim2.new(0, 30, 0, 30)
    logoBtn.Position = UDim2.new(0, 8, 0.85, 0)
    logoBtn.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
    logoBtn.Text = "ðŸ¦‹"
    logoBtn.TextSize = 14
    Instance.new("UICorner", logoBtn).CornerRadius = UDim.new(0, 6)
    logoBtn.Visible = false
    logoBtn.MouseButton1Click:Connect(function() mainFrame.Visible = true end)
    mainFrame:GetPropertyChangedSignal("Visible"):Connect(function() logoBtn.Visible = not mainFrame.Visible end)

    local function makeDraggable(frame)
        local dragging, dragStart, startPos = false
        frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = frame.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then dragging = false end
                end)
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                local delta = input.Position - dragStart
                frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
    end
    
    makeDraggable(mainFrame)
    makeDraggable(logoBtn)
    showPage(infoPage)
    
    task.spawn(function()
        task.wait(0.1)
        forceEnglish(gui)
        
        gui.DescendantAdded:Connect(function(obj)
            if obj:IsA("TextLabel") or obj:IsA("TextButton") then
                task.wait()
                pcall(function() obj.AutoLocalize = false end)
            end
        end)
    end)
    
    task.wait(0.3)
    
    if toggleRefs.autoFish then toggleRefs.autoFish(autoFishWasOn, true) end
    if toggleRefs.autoSell then toggleRefs.autoSell(autoSellWasOn, true) end
    if toggleRefs.autoClicker then toggleRefs.autoClicker(autoClickerWasOn, true) end
    if toggleRefs.fpsBoost then toggleRefs.fpsBoost(fpsBoostWasOn, true) end
    
    if activeIsland then
        for i, island in ipairs(islands) do
            if island == activeIsland and teleportToggles[i] then
                teleportToggles[i].setState(true, true)
                break
            end
        end
    end
    
    if clickPosition then
        clickIndicator.Position = UDim2.new(0, clickPosition.X - 25, 0, clickPosition.Y - 25)
    end
end

player.CharacterAdded:Connect(function()
    task.wait(1.5)
    
    autoSellRunning = false
    autoClickerRunning = false
    
    if autoFishWasOn then 
        enableAutoFish() 
    end
    
    if autoSellWasOn then 
        autoSellRunning = true
        autoSellLoop() 
    end
    
    if autoClickerWasOn then 
        autoClickerRunning = true
        autoClickerLoop()
        if clickPosition then
            clickIndicator.Visible = true
            clickIndicator.Position = UDim2.new(0, clickPosition.X - 25, 0, clickPosition.Y - 25)
        end
    end
    
    if fpsBoostWasOn then 
        enableFPSBoost() 
    end
    
    if activeIsland then 
        task.wait(0.3)
        teleportAndFace() 
    end
end)

buildUI()
