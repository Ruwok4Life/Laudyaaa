local player = game.Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local replicatedStorage = game:GetService("ReplicatedStorage")

local configPath = "LaudyaaaConfig_"..player.UserId..".json"
local toggles = {
    autoFish = false,
    autoSell = false,
    autoClicker = false,
    fpsBoost = false,
    teleportIndex = nil
}
if readfile and isfile and isfile(configPath) then
    local ok, data = pcall(function() return HttpService:JSONDecode(readfile(configPath)) end)
    if ok and typeof(data)=="table" then for k,v in pairs(data) do toggles[k]=v end end
end
local function saveToggles() if writefile then writefile(configPath,HttpService:JSONEncode(toggles)) end end

local islands = {
    { Name = "Esoteric Depths", Position = Vector3.new(3201.89, -1302.85, 1433.71) },
    { Name = "Treasure Room", Position = Vector3.new(-3611.89, -279.07, -1589.51) },
    { Name = "Lost Isle", Position = Vector3.new(-3738.2, -135.1, -1011.9) },
}
local activeIsland = toggles.teleportIndex and islands[toggles.teleportIndex] or nil

local autoSellRunning = false
local autoClickerRunning = false
local clickerDelay = 0.013 -- default 75cps, slider bisa up to 120
local settingClickPosition = false
local clickIndicator = nil
local autoClickerToggle = nil

---------------------------------
-- FISH, SELL DLL
local function getFishCount()
    local count = 0
    pcall(function()
        for _, gui in pairs(player.PlayerGui:GetDescendants()) do
            if (gui:IsA("TextLabel") or gui:IsA("TextButton")) and gui.Visible then
                local currentFish = gui.Text:match("(%d+)/")
                if currentFish then
                    local fishNum = tonumber(currentFish)
                    if fishNum and fishNum > count then count = fishNum end
                end
            end
        end
    end)
    return count
end

local function sellAllFish()
    pcall(function()
        local net = replicatedStorage:FindFirstChild("Packages")
        if not net then return end
        local idx = net:FindFirstChild("_Index")
        if not idx then return end
        local sleitnick = idx:FindFirstChild("sleitnick_net@0.2.0")
        if not sleitnick then return end
        local netFolder = sleitnick:FindFirstChild("net")
        if not netFolder then return end
        for _, remote in ipairs(netFolder:GetDescendants()) do
            if remote:IsA("RemoteFunction") or remote:IsA("RemoteEvent") then
                local name = remote.Name:lower()
                if name:find("sell") and not name:find("buy") then
                    pcall(function()
                        if remote:IsA("RemoteFunction") then remote:InvokeServer() else remote:FireServer() end
                    end)
                    task.wait(0.5)
                end
            end
        end
    end)
end
local function autoSellLoop()
    task.spawn(function()
        while autoSellRunning do
            task.wait(13)
            if getFishCount() >= 500 then sellAllFish() task.wait(2) end
        end
    end)
end

local function isAutoFishEnabled()
    local hasAutoFish = false
    pcall(function()
        for _, gui in pairs(player.PlayerGui:GetDescendants()) do
            if gui:IsA("TextButton") and gui.Visible then
                local t = gui.Text:lower()
                if t:find("auto") and t:find("fish") then
                    local c = gui.BackgroundColor3
                    if (c.r > 0.2 and c.g > 0.4) or c == Color3.fromRGB(0,162,255) then
                        hasAutoFish = true
                        break
                    end
                end
            end
        end
    end)
    return hasAutoFish
end

local function enableAutoFish()
    task.spawn(function()
        local char = player.Character
        if not char then return end
        local hasRod = false
        for _, tool in pairs(char:GetChildren()) do
            if tool:IsA("Tool") and tool.Name:lower():find("rod") then hasRod = true break end
        end
        if not hasRod then
            for _, tool in pairs(player.Backpack:GetChildren()) do
                if tool:IsA("Tool") and tool.Name:lower():find("rod") then
                    char.Humanoid:EquipTool(tool)
                    hasRod = true
                    break
                end
            end
        end
        if not hasRod then game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.One, false, game) task.wait(0.4) end
        if isAutoFishEnabled() then return end
        local net = replicatedStorage:FindFirstChild("Packages")
        if net then
            local idx = net:FindFirstChild("_Index")
            if idx then
                local sleitnick = idx:FindFirstChild("sleitnick_net@0.2.0")
                if sleitnick then
                    local netFolder = sleitnick:FindFirstChild("net")
                    if netFolder then
                        local rfFolder = netFolder:FindFirstChild("RF/UpdateAutoFishingState")
                        if rfFolder and rfFolder:IsA("RemoteFunction") then
                            pcall(function() rfFolder:InvokeServer(true) end)
                        end
                    end
                end
            end
        end
    end)
end

-- EXTREME FPS BOOST
local function enableFPSBoost()
    settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
    Lighting.Brightness = 1
    Lighting.GlobalShadows = false
    Lighting.OutdoorAmbient = Color3.new(1,1,1)
    Lighting.FogEnd = 15
    Lighting.FogStart = 0
    Lighting.ClockTime = 14
    Lighting.ColorShift_Bottom = Color3.new(0,0,0)
    Lighting.ColorShift_Top = Color3.new(0,0,0)
    Lighting.EnvironmentDiffuseScale = 0
    Lighting.EnvironmentSpecularScale = 0
    Lighting.ShadowSoftness = 1
    Lighting.GeographicLatitude = 0
    for _,v in ipairs(Lighting:GetChildren()) do pcall(function() v:Destroy() end) end
    settings().Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Level01
    task.spawn(function()
        for _, obj in pairs(workspace:GetDescendants()) do pcall(function()
            if obj:IsA("SurfaceLight") or obj:IsA("PointLight") or obj:IsA("SpotLight") or obj:IsA("ParticleEmitter") or obj:IsA("Trail")
            or obj:IsA("Smoke") or obj:IsA("Fire") or obj:IsA("Sparkles") then obj.Enabled = false
            elseif obj:IsA("BasePart") then obj.CastShadow = false; obj.Material = Enum.Material.SmoothPlastic; obj.Reflectance = 0
            elseif obj:IsA("Decal") or obj:IsA("Texture") then obj.Transparency = 1 end
        end) end
    end)
    pcall(function()
        workspace.Terrain.WaterTransparency = 1
        workspace.Terrain.WaterWaveSize = 0
        workspace.Terrain.WaterWaveSpeed = 0
        workspace.Terrain.WaterReflectance = 0
        workspace.Terrain.Decoration:ClearAllChildren()
    end)
end

local function disableFPSBoost()
    settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
    Lighting.Brightness = 2
    Lighting.GlobalShadows = true
    Lighting.FogEnd = 100000
end

local function teleportAndFace()
    local char = player.Character
    if not (char and char:FindFirstChild("HumanoidRootPart") and activeIsland) then return end
    local hrp = char.HumanoidRootPart
    hrp.CFrame = CFrame.new(activeIsland.Position + Vector3.new(0,5,0))
end

local function isMouseOverGui()
    if not gui then return false end
    local mousePos = UserInputService:GetMouseLocation()
    local guiObjects = player.PlayerGui:GetGuiObjectsAtPosition(mousePos.X, mousePos.Y)
    for _, obj in ipairs(guiObjects) do
        if obj:IsDescendantOf(gui) then return true end
    end
    return false
end

local function stopAutoClicker()
    autoClickerRunning = false
    if clickIndicator then clickIndicator.Visible = false end
    if autoClickerToggle then autoClickerToggle.BackgroundColor3 = Color3.fromRGB(32,36,55) end
end

local function autoClickerLoop()
    task.spawn(function()
        while autoClickerRunning do
            if clickIndicator and clickIndicator.Visible and not isMouseOverGui() then
                local abs = clickIndicator.AbsolutePosition
                local siz = clickIndicator.AbsoluteSize
                local cenX = abs.X + siz.X/2
                local cenY = abs.Y + siz.Y/2
                game:GetService("VirtualInputManager"):SendMouseButtonEvent(cenX, cenY, 0, true, game, 0)
                task.wait(0.006)
                game:GetService("VirtualInputManager"):SendMouseButtonEvent(cenX, cenY, 0, false, game, 0)
            end
            task.wait(clickerDelay)
        end
    end)
end

------------------------
-- GUI BEGIN
local function buildUI()
    if gui then return end
    gui = Instance.new("ScreenGui", player.PlayerGui)
    gui.Name = "LaudyaaaGui"
    gui.ResetOnSpawn = false

    local mainFrame = Instance.new("Frame", gui)
    mainFrame.Size = UDim2.new(0, 430, 0, 310)
    mainFrame.Position = UDim2.new(0.5,-215,0.5,-152)
    mainFrame.BackgroundColor3 = Color3.fromRGB(26,28,35)
    mainFrame.BorderSizePixel = 0
    Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 12)

    local titleBar = Instance.new("TextLabel", mainFrame)
    titleBar.Size = UDim2.new(1, 0, 0, 35)
    titleBar.Position = UDim2.new(0, 0, 0, 0)
    titleBar.Text = "ðŸ¦‹ Laudyaaa"
    titleBar.TextColor3 = Color3.fromRGB(180, 190, 255)
    titleBar.Font = Enum.Font.GothamBold
    titleBar.TextSize = 19
    titleBar.BackgroundTransparency = 1
    titleBar.TextXAlignment = Enum.TextXAlignment.Left

    local closeBtn = Instance.new("TextButton", mainFrame)
    closeBtn.Size = UDim2.new(0, 34, 0, 34)
    closeBtn.Position = UDim2.new(1, -44, 0, 3)
    closeBtn.Text = "()"
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 15
    closeBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    closeBtn.TextColor3 = Color3.fromRGB(220, 220, 230)
    Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 13)
    closeBtn.MouseButton1Click:Connect(function() mainFrame.Visible = false end)

    local content = Instance.new("ScrollingFrame", mainFrame)
    content.Position = UDim2.new(0, 24, 0, 44)
    content.Size = UDim2.new(1,-48,1,-60)
    content.CanvasSize = UDim2.new(0,0,0,0)
    content.BackgroundTransparency = 1
    content.ScrollBarThickness = 6
    local layout = Instance.new("UIListLayout", content)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0,10)

    -- FISH
    local fishHeader = Instance.new("TextLabel", content)
    fishHeader.Size = UDim2.new(1,-16,0,18)
    fishHeader.Text = "FISHING"
    fishHeader.Font = Enum.Font.GothamBold
    fishHeader.TextSize = 13
    fishHeader.TextColor3 = Color3.fromRGB(180,190,255)
    fishHeader.BackgroundTransparency = 1
    fishHeader.TextXAlignment = Enum.TextXAlignment.Left

    local autoFish = Instance.new("TextButton", content)
    autoFish.Size = UDim2.new(1,-14,0,26)
    autoFish.BackgroundColor3 = toggles.autoFish and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
    autoFish.Text = "Auto Fish"
    autoFish.TextColor3 = Color3.fromRGB(230,245,255)
    autoFish.TextSize = 12
    autoFish.Font = Enum.Font.GothamBold
    Instance.new("UICorner",autoFish).CornerRadius = UDim.new(0,10)
    autoFish.MouseButton1Click:Connect(function()
        toggles.autoFish = not toggles.autoFish; saveToggles()
        autoFish.BackgroundColor3 = toggles.autoFish and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
        if toggles.autoFish then enableAutoFish() end
    end)
    if toggles.autoFish then enableAutoFish() end

    -- AUTO SELL
    local autoSell = Instance.new("TextButton", content)
    autoSell.Size = UDim2.new(1,-14,0,26)
    autoSell.BackgroundColor3 = toggles.autoSell and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
    autoSell.Text = "Auto Sell (500 fish)"
    autoSell.TextColor3 = Color3.fromRGB(230,245,255)
    autoSell.TextSize = 12
    autoSell.Font = Enum.Font.GothamBold
    Instance.new("UICorner",autoSell).CornerRadius = UDim.new(0,10)
    autoSell.MouseButton1Click:Connect(function()
        toggles.autoSell = not toggles.autoSell; saveToggles()
        autoSell.BackgroundColor3 = toggles.autoSell and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
        autoSellRunning = toggles.autoSell
        if toggles.autoSell then autoSellLoop() end
    end)
    if toggles.autoSell then autoSellRunning=true autoSellLoop() end

    -- AUTO CLICKER
    local clickHeader = Instance.new("TextLabel", content)
    clickHeader.Size = UDim2.new(1,-16,0,18)
    clickHeader.Text = "AUTO CLICKER"
    clickHeader.Font = Enum.Font.GothamBold
    clickHeader.TextSize = 13
    clickHeader.TextColor3 = Color3.fromRGB(180,190,255)
    clickHeader.BackgroundTransparency = 1
    clickHeader.TextXAlignment = Enum.TextXAlignment.Left

    local slider = Instance.new("TextButton", content)
    slider.Size = UDim2.new(1,-18,0,20)
    slider.Text = "Click Speed: 77 CPS"
    slider.TextColor3 = Color3.fromRGB(215,220,230)
    slider.Font = Enum.Font.Gotham
    slider.TextSize = 11
    slider.BackgroundColor3 = Color3.fromRGB(55,55,80)
    Instance.new("UICorner",slider).CornerRadius = UDim.new(1,0)
    local dragging=false
    slider.MouseButton1Down:Connect(function() dragging=true end)
    UserInputService.InputEnded:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then dragging=false end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging then
            local pos
            if input.UserInputType == Enum.UserInputType.MouseMovement then pos = UserInputService:GetMouseLocation().X
            elseif input.UserInputType == Enum.UserInputType.Touch then pos = input.Position.X end
            if pos then
                local w = slider.AbsoluteSize.X
                local p = slider.AbsolutePosition.X
                local per = math.clamp((pos-p)/w,0.07,1)
                local v = math.floor(1/(per*0.008))
                clickerDelay = per*0.008
                slider.Text = ("Click Speed: %d CPS"):format(v)
            end
        end
    end)

    local setBtn = Instance.new("TextButton", content)
    setBtn.Size = UDim2.new(1,-8,0,32)
    setBtn.BackgroundColor3 = Color3.fromRGB(88,101,242)
    setBtn.Text = "Set Click Position"
    setBtn.Font = Enum.Font.GothamBold
    setBtn.TextSize = 12
    setBtn.TextColor3 = Color3.fromRGB(255,255,255)
    setBtn.AutoButtonColor = false
    Instance.new("UICorner",setBtn).CornerRadius = UDim.new(0,12)
    setBtn.MouseButton1Click:Connect(function()
        local connection
        connection = UserInputService.InputBegan:Connect(function(input)
            if input.UserInputType==Enum.UserInputType.MouseButton1 or input.UserInputType==Enum.UserInputType.Touch then
                local pos = UserInputService:GetMouseLocation()
                clickIndicator.Position = UDim2.new(0, pos.X - clickIndicator.AbsoluteSize.X/2, 0, pos.Y - clickIndicator.AbsoluteSize.Y/2)
                clickIndicator.Visible = true
                connection:Disconnect()
            end
        end)
    end)

    autoClickerToggle = Instance.new("TextButton", content)
    autoClickerToggle.Size = UDim2.new(1, -8, 0, 28)
    autoClickerToggle.BackgroundColor3 = toggles.autoClicker and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
    autoClickerToggle.Text = "Enable Auto Clicker"
    autoClickerToggle.Font = Enum.Font.GothamBold
    autoClickerToggle.TextSize = 13
    autoClickerToggle.TextColor3 = Color3.fromRGB(225,235,255)
    Instance.new("UICorner",autoClickerToggle).CornerRadius = UDim.new(0,12)
    autoClickerToggle.MouseButton1Click:Connect(function()
        autoClickerRunning = not autoClickerRunning
        toggles.autoClicker = autoClickerRunning; saveToggles()
        autoClickerToggle.BackgroundColor3 = autoClickerRunning and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
        if autoClickerRunning then if clickIndicator.Position then clickIndicator.Visible=true end autoClickerLoop()
        else stopAutoClicker() end
    end)
    if toggles.autoClicker then autoClickerRunning=true autoClickerToggle.BackgroundColor3 = Color3.fromRGB(88,101,242) autoClickerLoop() end

    -- TELEPORT
    local teleLabel = Instance.new("TextLabel", content)
    teleLabel.Size = UDim2.new(1,-16,0,18)
    teleLabel.Text = "TELEPORT"
    teleLabel.Font = Enum.Font.GothamBold
    teleLabel.TextSize = 13
    teleLabel.TextColor3 = Color3.fromRGB(180,190,255)
    teleLabel.BackgroundTransparency = 1
    teleLabel.TextXAlignment = Enum.TextXAlignment.Left
    local teleportToggles = {}
    for i,isl in ipairs(islands) do
        local btn = Instance.new("TextButton", content)
        btn.Size = UDim2.new(1,-8,0,26)
        btn.Text = isl.Name
        btn.TextColor3 = Color3.fromRGB(220,255,255)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 12
        btn.BackgroundColor3 = (toggles.teleportIndex==i) and Color3.fromRGB(85,140,255) or Color3.fromRGB(32,36,55)
        Instance.new("UICorner",btn).CornerRadius = UDim.new(0,10)
        teleportToggles[i] = btn
        btn.MouseButton1Click:Connect(function()
            for j,other in ipairs(teleportToggles) do
                other.BackgroundColor3 = Color3.fromRGB(32,36,55)
            end
            btn.BackgroundColor3 = Color3.fromRGB(85,140,255)
            activeIsland = isl
            toggles.teleportIndex = i
            saveToggles()
            teleportAndFace()
        end)
    end
    if toggles.teleportIndex and islands[toggles.teleportIndex] then teleportAndFace() end

    -- FPS BOOST
    local fpsHeader = Instance.new("TextLabel", content)
    fpsHeader.Size = UDim2.new(1,-16,0,16)
    fpsHeader.Text = "PERFORMANCE"
    fpsHeader.Font = Enum.Font.GothamBold
    fpsHeader.TextSize = 12
    fpsHeader.TextColor3 = Color3.fromRGB(180,190,255)
    fpsHeader.BackgroundTransparency = 1
    fpsHeader.TextXAlignment = Enum.TextXAlignment.Left
    local fpsBtn = Instance.new("TextButton", content)
    fpsBtn.Size = UDim2.new(1,-8,0,26)
    fpsBtn.BackgroundColor3 = toggles.fpsBoost and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
    fpsBtn.Text = "Extreme FPS Boost"
    fpsBtn.TextColor3 = Color3.fromRGB(225,255,225)
    fpsBtn.TextSize = 12
    fpsBtn.Font = Enum.Font.GothamBold
    Instance.new("UICorner",fpsBtn).CornerRadius = UDim.new(0,10)
    fpsBtn.MouseButton1Click:Connect(function()
        toggles.fpsBoost = not toggles.fpsBoost; saveToggles()
        fpsBtn.BackgroundColor3 = toggles.fpsBoost and Color3.fromRGB(88,101,242) or Color3.fromRGB(32,36,55)
        if toggles.fpsBoost then enableFPSBoost() else disableFPSBoost() end
    end)
    if toggles.fpsBoost then enableFPSBoost() end

    -- Click indicator (auto clicker)
    clickIndicator = Instance.new("TextButton", gui)
    clickIndicator.Size = UDim2.new(0,54,0,54)
    clickIndicator.BackgroundColor3 = Color3.fromRGB(88,101,242)
    clickIndicator.BackgroundTransparency = 0.10
    clickIndicator.BorderSizePixel = 0
    clickIndicator.Visible = false
    clickIndicator.ZIndex = 999
    clickIndicator.Text = ""
    clickIndicator.AutoButtonColor = false
    Instance.new("UICorner", clickIndicator).CornerRadius = UDim.new(1,0)
    local innerCircle = Instance.new("Frame", clickIndicator)
    innerCircle.Size = UDim2.new(0,16,0,16)
    innerCircle.Position = UDim2.new(0.5,-8,0.5,-8)
    innerCircle.BackgroundColor3 = Color3.fromRGB(255,255,255)
    innerCircle.BorderSizePixel = 0
    Instance.new("UICorner", innerCircle).CornerRadius = UDim.new(1,0)
    local stopLabel = Instance.new("TextLabel", clickIndicator)
    stopLabel.Size = UDim2.new(1,0,0,16)
    stopLabel.Position = UDim2.new(0,0,1,2)
    stopLabel.Text = "Tap to Stop"
    stopLabel.TextColor3 = Color3.fromRGB(255,255,255)
    stopLabel.Font = Enum.Font.GothamBold
    stopLabel.TextSize = 12
    stopLabel.BackgroundTransparency = 1
    clickIndicator.MouseButton1Click:Connect(function() stopAutoClicker() end)

    -- LOGO minimize
    local logoBtn = Instance.new("TextButton", gui)
    logoBtn.Size = UDim2.new(0, 56, 0, 56)
    logoBtn.Position = UDim2.new(0, 8, 0.86, 0)
    logoBtn.BackgroundColor3 = Color3.fromRGB(24,24,34)
    logoBtn.Text = "ðŸ¦‹"
    logoBtn.TextSize = 28
    logoBtn.AutoButtonColor = true
    Instance.new("UICorner", logoBtn).CornerRadius = UDim.new(0, 22)
    logoBtn.Visible = false
    logoBtn.MouseButton1Click:Connect(function() mainFrame.Visible = true end)
    mainFrame:GetPropertyChangedSignal("Visible"):Connect(function() logoBtn.Visible = not mainFrame.Visible end)

    local function makeDraggable(frame)
        local dragging, dragStart, startPos
        frame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = frame.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then dragging = false end
                end)
            end
        end)
        UserInputService.InputChanged:Connect(function(input)
            if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                local delta = input.Position - dragStart
                frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
    end

    makeDraggable(mainFrame)
    makeDraggable(logoBtn)

    -- Show default page info
    showPage(infoPage)
end

-- Reload toggles and features on respawn
player.CharacterAdded:Connect(function()
    wait(1.5)
    if toggles.teleportIndex and islands[toggles.teleportIndex] then
        activeIsland = islands[toggles.teleportIndex]
        teleportAndFace()
    end
    if toggles.autoClicker then
        autoClickerRunning = true
        autoClickerLoop()
        if clickIndicator then clickIndicator.Visible = true end
    end
    if toggles.autoFish then enableAutoFish() end
    if toggles.autoSell then autoSellRunning = true; autoSellLoop() end
    if toggles.fpsBoost then enableFPSBoost() end
end)

buildUI()
